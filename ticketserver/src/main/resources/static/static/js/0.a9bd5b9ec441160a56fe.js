webpackJsonp([0],{"2eoi":function(e,t,i){var s={"./Home.vue":"lO7g","./Login.vue":"xJsL","./chat/Chat.vue":"T5Y6","./chat/FriendChat.vue":"ngyR","./chat/Notification.vue":"Gpj+","./system/DepMana.vue":"aS53","./system/MenuRole.vue":"Bg5L","./system/SysBasic.vue":"fc7a","./system/SysHr.vue":"ewEk","./system/SysLog.vue":"ZDkW","./ticket/TktAll.vue":"7lhF","./ticket/TktDetail.vue":"nFJj","./ticket/TktList.vue":"CGYL","./ticket/TktNew.vue":"m12F"};function a(e){return i(l(e))}function l(e){var t=s[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}a.keys=function(){return Object.keys(s)},a.resolve=l,e.exports=a,a.id="2eoi"},"6mHw":function(e,t){},"7lhF":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{"margin-top":"22px"}},[i("el-container",[i("el-main",{staticStyle:{"padding-left":"0px","padding-top":"0px"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.advanceSearchViewVisible,expression:"advanceSearchViewVisible"}],staticClass:"search-box"},[i("el-row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[i("el-col",{attrs:{span:6}},[i("el-input",{staticStyle:{width:"97%"},attrs:{placeholder:"请输入工单编号...","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.searchTicket(t):null}},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}})],1),e._v(" "),i("el-col",{attrs:{span:6}},[i("el-select",{staticStyle:{width:"97%"},attrs:{placeholder:"请选择申报形式"},model:{value:e.ticket.declarationId,callback:function(t){e.$set(e.ticket,"declarationId",t)},expression:"ticket.declarationId"}},e._l(e.declarations,function(e){return i("el-option",{key:e.declaration_id,attrs:{label:e.description,value:e.declaration_id}})}),1)],1),e._v(" "),i("el-col",{attrs:{span:6}},[i("el-select",{staticStyle:{width:"97%"},attrs:{placeholder:"请选择来源分类"},model:{value:e.ticket.sourceId,callback:function(t){e.$set(e.ticket,"sourceId",t)},expression:"ticket.sourceId"}},e._l(e.sources,function(e){return i("el-option",{key:e.source_id,attrs:{label:e.description,value:e.source_id}})}),1)],1),e._v(" "),i("el-col",{attrs:{span:6}},[i("el-select",{staticStyle:{width:"97%"},attrs:{placeholder:"请选择服务分类"},model:{value:e.ticket.serverId,callback:function(t){e.$set(e.ticket,"serverId",t)},expression:"ticket.serverId"}},e._l(e.servers,function(e){return i("el-option",{key:e.server_id,attrs:{label:e.description,value:e.server_id}})}),1)],1)],1),e._v(" "),i("el-row",{staticStyle:{"margin-bottom":"0px"}},[i("el-col",{attrs:{span:6}},[i("el-select",{staticStyle:{width:"97%"},attrs:{placeholder:"请选择影响范围"},model:{value:e.ticket.affectId,callback:function(t){e.$set(e.ticket,"affectId",t)},expression:"ticket.affectId"}},e._l(e.affects,function(e){return i("el-option",{key:e.affect_id,attrs:{label:e.description,value:e.affect_id}})}),1)],1),e._v(" "),i("el-col",{attrs:{span:6}},[i("el-select",{staticStyle:{width:"97%"},attrs:{placeholder:"请选择优先级"},model:{value:e.ticket.priorityId,callback:function(t){e.$set(e.ticket,"priorityId",t)},expression:"ticket.priorityId"}},e._l(e.priorities,function(e){return i("el-option",{key:e.priority_id,attrs:{label:e.description,value:e.priority_id}})}),1)],1),e._v(" "),i("el-col",{attrs:{span:6}},[i("el-select",{staticStyle:{width:"97%"},attrs:{placeholder:"请选择工单状态"},model:{value:e.ticket.status,callback:function(t){e.$set(e.ticket,"status",t)},expression:"ticket.status"}},e._l(e.statuses,function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),i("el-col",{attrs:{span:6}},[i("el-badge",{staticStyle:{width:"97%"}},[i("el-tooltip",{attrs:{effect:"light",content:"查询",placement:"left"}}),e._v(" "),i("el-button",{staticClass:"myButtonQ",attrs:{size:"mini",type:"primary",icon:"el-icon-search"},on:{click:e.searchTicket}},[e._v("查询")]),e._v("\n                      \n              "),i("el-tooltip",{attrs:{effect:"light",content:"刷新",placement:"right"}}),e._v(" "),i("el-button",{staticClass:"myButtonR",attrs:{size:"mini",type:"success",icon:"el-icon-refresh"},on:{click:e.cancelSearch}},[e._v("刷新")])],1)],1)],1)],1),e._v(" "),i("div",{staticClass:"myTable",staticStyle:{"margin-top":"15px"}},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{data:e.tickets,border:"",stripe:"",size:"mini","header-cell-style":{background:"#f0f0f0",color:"#68727c"}},on:{"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{prop:"logId",fixed:"left",label:"工单编号",width:"140",align:"left","show-overflow-tooltip":"true"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("router-link",{staticStyle:{color:"#0b6dd8","text-decoration":"none"},attrs:{to:{path:"/tkt/detail",query:{index:t.$index,row:t.row,backroute:"/tkt/all"}}}},[e._v("\n                "+e._s(t.row.logId)+"\n              ")])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"150",label:"工单生成时间",align:"left","show-overflow-tooltip":"true"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("formatDateTime")(t.row.createdDate)))]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"title",label:"事件标题",width:"150",align:"left","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{prop:"customerName",label:"申报人",width:"120",align:"left","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{prop:"customerId",label:"申报人组织",width:"120",align:"left","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{prop:"mobile",label:"申报人手机",width:"120",align:"left","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{prop:"tel",label:"申报人座机",width:"120",align:"left","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{prop:"email",label:"申报人邮箱",width:"150",align:"left","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{prop:"vipdesc",label:"VIP",width:"120",align:"left","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"declaration.description",label:"申报形式","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"source.description",label:"来源分类","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"server.description",label:"服务分类","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"questiontype.description",label:"问题分类","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"subclass.description",label:"问题子分类","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"affect.description",label:"影响范围","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"priority.description",label:"优先级","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"emailGroup.description",label:"转发地址","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"hr.name",label:"责任人","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{fixed:"right",prop:"status",label:"工单状态",width:"135",align:"left","show-overflow-tooltip":"true"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-tag",{attrs:{type:e._f("statusFilter")(t.row.status)}},[e._v(e._s(t.row.status))]),e._v(" "),i("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:"分配",placement:"top"}}),e._v(" "),"New"==t.row.status?i("el-tag",{attrs:{type:"danger"},nativeOn:{click:function(i){e.showEditTicketView(t.$index,t.row)}}},[i("i",{staticClass:"el-icon-edit-outline"},[e._v(e._s("分配"))])]):e._e()]}}])})],1),e._v(" "),i("div",{staticStyle:{padding:"20px 5px"}},[i("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)])],1),e._v(" "),i("el-form",{ref:"assignTicketForm",attrs:{model:e.ticket,rules:e.rules}},[i("div",{staticClass:"myDialog"},[i("el-dialog",{attrs:{title:e.ticketEdit,visible:e.dialogVisible,width:"20%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("div",{staticClass:"mt20"}),e._v(" "),i("el-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{disabled:!0,placeholder:"请输入新的工单编号..."},model:{value:e.updateLogId,callback:function(t){e.updateLogId=t},expression:"updateLogId"}}),e._v(" "),i("el-form-item",{attrs:{"label-width":"90px",label:"责任人:",prop:"assigneeId"}},[i("el-select",{attrs:{placeholder:"请选择责任人"},on:{change:e.currentSel},model:{value:e.ticket.assigneeId,callback:function(t){e.$set(e.ticket,"assigneeId",t)},expression:"ticket.assigneeId"}},e._l(e.assignees,function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),i("div",{staticClass:"mt10"}),e._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{staticClass:"myButtonQ",attrs:{type:"primary"},on:{click:e.updateTicketExec}},[e._v("确 定")])],1)],1)],1)])],1)},staticRenderFns:[]};var a=i("VU/8")({components:{},name:"TicketListTable",filters:{statusFilter:function(e){return{New:"danger",Assigned:"warning","In progress":"",Pending:"",Resolved:"info",Closed:"success"}[e]}},data:function(){return{tickets:[],keywords:"",title:"",positionName:"",declarations:[],sources:[],priorities:[],servers:[],affects:[],assignees:[],emailgroups:[],status:"",updateLogId:"",rowindex:"",assignee:"",updateTitleLevel:"",faangledoubleup:"fa-angle-double-up",faangledoubledown:"fa-angle-double-down",ticketEdit:"分配工单",titleLevel:"",updatePosId:-1,totalCount:-1,currentPage:1,pageSize:10,tableLoading:!1,dialogVisible:!1,multipleSelection:[],type:[],statuses:["New","Assigned","In progress","Pending","Closed"],advanceSearchViewVisible:!0,ticket:{logId:"",title:"",createdDate:"",customerName:"",customerId:"",mobile:"",tel:"",email:"",vipdesc:"",status:"",declarationId:"",sourceId:"",serverId:"",affectId:"",priorityId:"",assigneeId:"",groupId:""},hr:{address:"",dept:"",enabled:"",id:"",name:"",phone:"",roles:"",email:"",userface:"",username:""},rules:{declarationId:[{required:!0,message:"必填:申报形式",trigger:"change"}]}}},mounted:function(){this.initData(),this.loadTickets()},methods:{updateTicketExec:function(){var e=this;if(this.isNotNullORBlank(this.updateLogId)){this.tableLoading=!0;var t=this;this.putRequest("/ticket/basic/assign",{logId:this.updateLogId,assigneeId:this.ticket.assigneeId}).then(function(i){if(t.tableLoading=!1,i&&200==i.status){e.dialogVisible=!1;var s=i.data;t.$message({type:s.status,message:s.msg}),e.emptyTicketList(),e.loadTickets(),e.postRequest("/chat/nf",{message:e.updateLogId+" 已被分配给 "+e.assignee,title:e.updateLogId+" 已被分配给 "+e.assignee}).then(function(e){e&&200==e.status&&"success"==e.data.status&&(t.$store.commit("toggleNFDot",!0),t.$store.state.stomp.send("/ws/nf",{},""),t.initSysMsgs(),t.cancelSend())})}})}else this.$message.warning("工单编号不能为空!")},currentSel:function(e){var t;t=this.assignees.find(function(t){return t.id===e}),this.assignee=t.name},cancelSearch:function(){this.advanceSearchViewVisible=!0,this.emptyTicketList(),this.loadTickets()},handleSelectionChange:function(e){this.multipleSelection=e},handleDelete:function(e,t){var i=this,s=this;this.$confirm("删除["+t.name+"], 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.doDelete(t.id)}).catch(function(){i.$message({type:"info",message:"已取消删除"})})},doDelete:function(e){var t=this;t.tableLoading=!0,this.deleteRequest("/system/basic/joblevel/"+e).then(function(e){t.tableLoading=!1,e&&200==e.status&&t.loadTableData()})},loadTableData:function(){var e=this;this.tableLoading=!0,this.getRequest("/ticket/tickets").then(function(t){e.tableLoading=!1})},initData:function(){var e=this;this.getRequest("/ticket/basic/lovdata").then(function(t){if(t&&200==t.status){var i=t.data;e.declarations=i.declarations,e.sources=i.sources,e.priorities=i.priorities,e.servers=i.servers,e.questiontypes=i.questiontypes,e.subclasses=i.subclasses,e.affects=i.affects,e.assignees=i.assignees,e.emailgroups=i.emailgroups}})},showEditTicketView:function(e,t){this.rowindex=e,this.updateLogId=t.logId,this.dialogVisible=!0},searchTicket:function(){this.loadTickets()},handleSizeChange:function(e){this.pageSize=e,this.loadTickets()},handleCurrentChange:function(e){this.currentPage=e,this.loadTickets()},loadTickets:function(){var e=this,t=this;this.tableLoading=!0,this.getRequest("/ticket/basic/tkt?page="+this.currentPage+"&size="+this.pageSize+"&keywords="+this.keywords+"&declarationId="+this.ticket.declarationId+"&sourceId="+this.ticket.sourceId+"&serverId="+this.ticket.serverId+"&affectId="+this.ticket.affectId+"&priorityId="+this.ticket.priorityId+"&status="+this.ticket.status+"&assigneeId="+this.ticket.assigneeId+"&groupId="+this.ticket.groupId).then(function(i){if(e.tableLoading=!1,i&&200==i.status){var s=i.data;t.tickets=s.tickets,t.totalCount=s.count}})},emptyTicketList:function(){this.ticket={logId:"",title:"",createdDate:"",customerName:"",customerId:"",mobile:"",tel:"",email:"",vipdesc:"",status:"",declarationId:"",sourceId:"",serverId:"",affectId:"",priorityId:"",assigneeId:"",groupId:"",rowindex:""},this.keywords=""}},computed:{user:function(){return this.$store.state.user},routes:function(){return this.$store.state.routes}}},s,!1,function(e){i("qPzJ")},"data-v-29867789",null);t.default=a.exports},Bg5L:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i("oAV5"),a={mounted:function(){this.loading=!0,this.initRoles()},methods:{deleteRole:function(e,t){var i=this;this.$confirm("删除角色["+t+"], 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){i.loading=!0,i.deleteRequest("/system/basic/role/"+e).then(function(e){if(e&&200==e.status){var t=e.data;i.$message({type:t.status,message:t.msg}),i.initRoles()}else i.loading=!1})}).catch(function(){i.$message({type:"info",message:"已取消删除"})})},addNewRole:function(){if(Object(s.b)(this.newRole,this.newRoleZh)){this.loading=!0;var e=this;this.postRequest("/system/basic/addRole",{role:this.newRole,roleZh:this.newRoleZh}).then(function(t){if(t&&200==t.status){var i=t.data;e.$message({type:i.status,message:i.msg}),e.initRoles(),e.newRole="",e.newRoleZh=""}else e.loading=!1})}},updateRoleMenu:function(e){var t=this.$refs.tree[e].getCheckedKeys(!0),i=this;this.putRequest("/system/basic/updateMenuRole",{rid:this.activeColItem,mids:t}).then(function(e){if(e&&200==e.status){var t=e.data;i.$message({type:t.status,message:t.msg}),i.activeColItem=-1}})},collapseChange:function(e){if(""!=e){var t=this;this.getRequest("/system/basic/menuTree/"+e).then(function(e){if(e&&200==e.status){var i=e.data;t.treeData=i.menus,t.checkedKeys=i.mids}})}},handleCheckChange:function(e,t,i){},initRoles:function(){var e=this;this.getRequest("/system/basic/roles").then(function(t){e.loading=!1,t&&200==t.status&&(e.roles=t.data,e.activeColItem=-1)})},cancelUpdateRoleMenu:function(){this.activeColItem=-1}},data:function(){return{props:{label:"name",children:"children"},newRole:"",newRoleZh:"",roles:[],treeData:[],checkedKeys:[],loading:!1,activeColItem:-1}}},l={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"text-align":"left"}},[i("el-input",{staticClass:"myInput",attrs:{placeholder:"请输入角色英文名称...",size:"mini"},model:{value:e.newRole,callback:function(t){e.newRole=t},expression:"newRole"}},[i("template",{slot:"prepend"},[e._v("ROLE_")])],2),e._v(" "),i("el-input",{staticStyle:{width:"42%"},attrs:{placeholder:"请输入角色中文名称...",size:"mini"},model:{value:e.newRoleZh,callback:function(t){e.newRoleZh=t},expression:"newRoleZh"}}),e._v(" "),i("el-button",{staticStyle:{"margin-left":"5px","background-color":"#3771de","border-color":"#3771de"},attrs:{type:"primary",size:"mini"},on:{click:e.addNewRole}},[e._v("添加角色")])],1),e._v(" "),i("div",{staticStyle:{"margin-top":"10px","text-align":"left"}},[i("el-collapse",{staticStyle:{width:"100%"},attrs:{accordion:""},on:{change:e.collapseChange},model:{value:e.activeColItem,callback:function(t){e.activeColItem=t},expression:"activeColItem"}},e._l(e.roles,function(t,s){return i("el-collapse-item",{key:t.name,attrs:{title:t.nameZh,name:t.id}},[i("el-card",{staticClass:"box-card"},[i("div",{attrs:{slot:"header"},slot:"header"},[i("span",[e._v("可访问的资源")]),e._v(" "),i("el-button",{staticStyle:{color:"#f6061b",margin:"0px",float:"right",padding:"3px 0",width:"15px",height:"15px"},attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(i){e.deleteRole(t.id,t.nameZh)}}})],1),e._v(" "),i("div",[i("el-tree",{key:t.id,ref:"tree",refInFor:!0,attrs:{props:e.props,data:e.treeData,"default-checked-keys":e.checkedKeys,"node-key":"id","show-checkbox":"","highlight-current":""},on:{"check-change":e.handleCheckChange}})],1),e._v(" "),i("div",{staticClass:"menuButton"},[i("el-button",{attrs:{size:"mini"},on:{click:e.cancelUpdateRoleMenu}},[e._v("取消修改")]),e._v(" "),i("el-button",{staticStyle:{"background-color":"#3771de","border-color":"#3771de"},attrs:{type:"primary",size:"mini"},on:{click:function(t){e.updateRoleMenu(s)}}},[e._v("确认修改")])],1)])],1)}),1)],1)])},staticRenderFns:[]};var o=i("VU/8")(a,l,!1,function(e){i("dcSv")},"data-v-2e154cec",null);t.default=o.exports},CGYL:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{"margin-top":"22px"}},[i("el-container",[i("el-main",{staticStyle:{"padding-left":"0px","padding-top":"0px"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.advanceSearchViewVisible,expression:"advanceSearchViewVisible"}],staticClass:"search-box"},[i("el-row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[i("el-col",{attrs:{span:6}},[i("el-input",{staticStyle:{width:"97%"},attrs:{placeholder:"请输入工单编号...","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.searchTicket(t):null}},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}})],1),e._v(" "),i("el-col",{attrs:{span:6}},[i("el-select",{staticStyle:{width:"97%"},attrs:{placeholder:"请选择申报形式"},model:{value:e.ticket.declarationId,callback:function(t){e.$set(e.ticket,"declarationId",t)},expression:"ticket.declarationId"}},e._l(e.declarations,function(e){return i("el-option",{key:e.declaration_id,attrs:{label:e.description,value:e.declaration_id}})}),1)],1),e._v(" "),i("el-col",{attrs:{span:6}},[i("el-select",{staticStyle:{width:"97%"},attrs:{placeholder:"请选择来源分类"},model:{value:e.ticket.sourceId,callback:function(t){e.$set(e.ticket,"sourceId",t)},expression:"ticket.sourceId"}},e._l(e.sources,function(e){return i("el-option",{key:e.source_id,attrs:{label:e.description,value:e.source_id}})}),1)],1),e._v(" "),i("el-col",{attrs:{span:6}},[i("el-select",{staticStyle:{width:"97%"},attrs:{placeholder:"请选择服务分类"},model:{value:e.ticket.serverId,callback:function(t){e.$set(e.ticket,"serverId",t)},expression:"ticket.serverId"}},e._l(e.servers,function(e){return i("el-option",{key:e.server_id,attrs:{label:e.description,value:e.server_id}})}),1)],1)],1),e._v(" "),i("el-row",{staticStyle:{"margin-bottom":"0px"}},[i("el-col",{attrs:{span:6}},[i("el-select",{staticStyle:{width:"97%"},attrs:{placeholder:"请选择影响范围"},model:{value:e.ticket.affectId,callback:function(t){e.$set(e.ticket,"affectId",t)},expression:"ticket.affectId"}},e._l(e.affects,function(e){return i("el-option",{key:e.affect_id,attrs:{label:e.description,value:e.affect_id}})}),1)],1),e._v(" "),i("el-col",{attrs:{span:6}},[i("el-select",{staticStyle:{width:"97%"},attrs:{placeholder:"请选择优先级"},model:{value:e.ticket.priorityId,callback:function(t){e.$set(e.ticket,"priorityId",t)},expression:"ticket.priorityId"}},e._l(e.priorities,function(e){return i("el-option",{key:e.priority_id,attrs:{label:e.description,value:e.priority_id}})}),1)],1),e._v(" "),i("el-col",{attrs:{span:6}},[i("el-select",{staticStyle:{width:"97%"},attrs:{placeholder:"请选择工单状态"},model:{value:e.ticket.status,callback:function(t){e.$set(e.ticket,"status",t)},expression:"ticket.status"}},e._l(e.statuses,function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),i("el-col",{attrs:{span:6}},[i("el-badge",{staticStyle:{width:"97%"}},[i("el-tooltip",{attrs:{effect:"light",content:"查询",placement:"left"}}),e._v(" "),i("el-button",{staticClass:"myButtonQ",attrs:{size:"mini",type:"primary",icon:"el-icon-search"},on:{click:e.searchTicket}},[e._v("查询")]),e._v("\n                      \n              "),i("el-tooltip",{attrs:{effect:"light",content:"刷新",placement:"right"}}),e._v(" "),i("el-button",{staticClass:"myButtonR",attrs:{size:"mini",type:"success",icon:"el-icon-refresh"},on:{click:e.cancelSearch}},[e._v("刷新")])],1)],1)],1)],1),e._v(" "),i("div",{staticClass:"myTable",staticStyle:{"margin-top":"15px"}},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{data:e.tickets,border:"",stripe:"",size:"mini","header-cell-style":{background:"#f0f0f0",color:"#68727c"}},on:{"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{prop:"logId",fixed:"left",label:"工单编号",width:"140",align:"left","show-overflow-tooltip":"true"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("router-link",{staticStyle:{color:"#0b6dd8","text-decoration":"none"},attrs:{to:{path:"/tkt/detail",query:{index:t.$index,row:t.row,backroute:"/tkt/list"}}}},[e._v("\n                "+e._s(t.row.logId)+"\n              ")])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"150",label:"工单生成时间",align:"left","show-overflow-tooltip":"true"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("formatDateTime")(t.row.createdDate)))]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"title",label:"事件标题",width:"150",align:"left","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{prop:"customerName",label:"申报人",width:"120",align:"left","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{prop:"customerId",label:"申报人组织",width:"120",align:"left","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{prop:"mobile",label:"申报人手机",width:"120",align:"left","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{prop:"tel",label:"申报人座机",width:"120",align:"left","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{prop:"email",label:"申报人邮箱",width:"150",align:"left","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{prop:"vipdesc",label:"VIP",width:"120",align:"left","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"declaration.description",label:"申报形式","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"source.description",label:"来源分类","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"server.description",label:"服务分类","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"questiontype.description",label:"问题分类","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"subclass.description",label:"问题子分类","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"affect.description",label:"影响范围","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"priority.description",label:"优先级","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"emailGroup.description",label:"转发地址","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"hr.name",label:"责任人","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{fixed:"right",prop:"status",label:"工单状态",width:"135",align:"left","show-overflow-tooltip":"true"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-tag",{attrs:{type:e._f("statusFilter")(t.row.status)}},[e._v(e._s(t.row.status))]),e._v(" "),i("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:"分配",placement:"top"}}),e._v(" "),"New"==t.row.status?i("el-tag",{attrs:{type:"danger"},nativeOn:{click:function(i){e.showEditTicketView(t.$index,t.row)}}},[i("i",{staticClass:"el-icon-edit-outline"},[e._v(e._s("分配"))])]):e._e()]}}])})],1),e._v(" "),i("div",{staticStyle:{padding:"20px 5px"}},[i("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)])],1),e._v(" "),i("el-form",{ref:"assignTicketForm",attrs:{model:e.ticket,rules:e.rules}},[i("div",{staticClass:"myDialog"},[i("el-dialog",{attrs:{title:e.ticketEdit,visible:e.dialogVisible,width:"20%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("div",{staticClass:"mt20"}),e._v(" "),i("el-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{disabled:!0,placeholder:"请输入新的工单编号..."},model:{value:e.updateLogId,callback:function(t){e.updateLogId=t},expression:"updateLogId"}}),e._v(" "),i("el-form-item",{attrs:{"label-width":"90px",label:"责任人:",prop:"assigneeId"}},[i("el-select",{attrs:{placeholder:"请选择责任人"},on:{change:e.currentSel},model:{value:e.ticket.assigneeId,callback:function(t){e.$set(e.ticket,"assigneeId",t)},expression:"ticket.assigneeId"}},e._l(e.assignees,function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),i("div",{staticClass:"mt10"}),e._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{staticClass:"myButtonQ",attrs:{type:"primary"},on:{click:e.updateTicketExec}},[e._v("确 定")])],1)],1)],1)])],1)},staticRenderFns:[]};var a=i("VU/8")({components:{},name:"TicketListTable",filters:{statusFilter:function(e){return{New:"danger",Assigned:"warning","In progress":"",Pending:"",Resolved:"info",Closed:"success"}[e]}},data:function(){return{tickets:[],keywords:"",title:"",positionName:"",declarations:[],sources:[],priorities:[],servers:[],affects:[],assignees:[],emailgroups:[],status:"",updateLogId:"",rowindex:"",assignee:"",updateTitleLevel:"",faangledoubleup:"fa-angle-double-up",faangledoubledown:"fa-angle-double-down",ticketEdit:"分配工单",titleLevel:"",updatePosId:-1,totalCount:-1,currentPage:1,pageSize:10,tableLoading:!1,dialogVisible:!1,multipleSelection:[],type:[],statuses:["New","Assigned","In progress","Pending","Closed"],advanceSearchViewVisible:!0,ticket:{logId:"",title:"",createdDate:"",customerName:"",customerId:"",mobile:"",tel:"",email:"",vipdesc:"",status:"",declarationId:"",sourceId:"",serverId:"",affectId:"",priorityId:"",assigneeId:"",groupId:""},hr:{address:"",dept:"",enabled:"",id:"",name:"",phone:"",roles:"",email:"",userface:"",username:""},rules:{declarationId:[{required:!0,message:"必填:申报形式",trigger:"change"}]}}},mounted:function(){this.initData(),this.loadTickets()},methods:{updateTicketExec:function(){var e=this;if(this.isNotNullORBlank(this.updateLogId)){this.tableLoading=!0;var t=this;this.putRequest("/ticket/basic/assign",{logId:this.updateLogId,assigneeId:this.ticket.assigneeId}).then(function(i){if(t.tableLoading=!1,i&&200==i.status){e.dialogVisible=!1;var s=i.data;t.$message({type:s.status,message:s.msg}),e.emptyTicketList(),e.loadTickets(),e.postRequest("/chat/nf",{message:e.updateLogId+" 已被分配给 "+e.assignee,title:e.updateLogId+" 已被分配给 "+e.assignee}).then(function(e){e&&200==e.status&&"success"==e.data.status&&(t.$store.commit("toggleNFDot",!0),t.$store.state.stomp.send("/ws/nf",{},""),t.initSysMsgs(),t.cancelSend())})}})}else this.$message.warning("工单编号不能为空!")},currentSel:function(e){var t;t=this.assignees.find(function(t){return t.id===e}),this.assignee=t.name},cancelSearch:function(){this.advanceSearchViewVisible=!0,this.emptyTicketList(),this.loadTickets()},handleSelectionChange:function(e){this.multipleSelection=e},handleDelete:function(e,t){var i=this,s=this;this.$confirm("删除["+t.name+"], 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.doDelete(t.id)}).catch(function(){i.$message({type:"info",message:"已取消删除"})})},doDelete:function(e){var t=this;t.tableLoading=!0,this.deleteRequest("/system/basic/joblevel/"+e).then(function(e){t.tableLoading=!1,e&&200==e.status&&t.loadTableData()})},loadTableData:function(){var e=this;this.tableLoading=!0,this.getRequest("/ticket/tickets").then(function(t){e.tableLoading=!1})},initData:function(){var e=this;this.getRequest("/ticket/basic/lovdata").then(function(t){if(t&&200==t.status){var i=t.data;e.declarations=i.declarations,e.sources=i.sources,e.priorities=i.priorities,e.servers=i.servers,e.questiontypes=i.questiontypes,e.subclasses=i.subclasses,e.affects=i.affects,e.assignees=i.assignees,e.emailgroups=i.emailgroups}})},showEditTicketView:function(e,t){this.rowindex=e,this.updateLogId=t.logId,this.dialogVisible=!0},searchTicket:function(){this.loadTickets()},handleSizeChange:function(e){this.pageSize=e,this.loadTickets()},handleCurrentChange:function(e){this.currentPage=e,this.loadTickets()},loadTickets:function(){var e=this,t=this;this.tableLoading=!0,this.getRequest("/ticket/basic/tkt?page="+this.currentPage+"&size="+this.pageSize+"&keywords="+this.keywords+"&declarationId="+this.ticket.declarationId+"&sourceId="+this.ticket.sourceId+"&serverId="+this.ticket.serverId+"&affectId="+this.ticket.affectId+"&priorityId="+this.ticket.priorityId+"&status="+this.ticket.status+"&assigneeId="+this.user.id+"&groupId="+this.ticket.groupId).then(function(i){if(e.tableLoading=!1,i&&200==i.status){var s=i.data;t.tickets=s.tickets,t.totalCount=s.count}})},emptyTicketList:function(){this.ticket={logId:"",title:"",createdDate:"",customerName:"",customerId:"",mobile:"",tel:"",email:"",vipdesc:"",status:"",declarationId:"",sourceId:"",serverId:"",affectId:"",priorityId:"",assigneeId:"",groupId:"",rowindex:""},this.keywords=""}},computed:{user:function(){return this.$store.state.user},routes:function(){return this.$store.state.routes}}},s,!1,function(e){i("6mHw")},"data-v-9264f23e",null);t.default=a.exports},"F+2t":function(e,t){},HfvY:function(e,t){},ZDkW:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("h1",[this._v("\n    操作日志管理\n  ")])])}]},a=i("VU/8")(null,s,!1,null,null,null);t.default=a.exports},aS53:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={data:function(){return{keywords:"",depName:"",treeLoading:!1,dialogVisible:!1,allDeps:[],pDep:"",treeData:[],defaultProps:{label:"name",isLeaf:"leaf",children:"children"}}},mounted:function(){this.treeLoading=!0,this.loadTreeData()},watch:{keywords:function(e){this.$refs.tree.filter(e)}},methods:{filterNode:function(e,t){return!e||-1!==t.name.indexOf(e)},loadTreeData:function(){var e=this;this.getRequest("/system/basic/dep/-1").then(function(t){e.treeLoading=!1,t&&200==t.status&&(e.treeData=t.data)})},setDataToTree:function(e,t,i){for(var s=0;s<e.length;s++){var a=e[s];if(a.id==t)return void(e[s].children=e[s].children.concat(i));this.setDataToTree(a.children,t,i)}},addDep:function(){var e=this;this.dialogVisible=!1,this.treeLoading=!0,this.postRequest("/system/basic/dep",{name:this.depName,parentId:this.pDep}).then(function(t){if(e.treeLoading=!1,t&&200==t.status){var i=t.data;e.depName="",e.$message({type:i.status,message:"添加成功!"}),e.setDataToTree(e.treeData,e.pDep,i.msg)}})},loadAllDeps:function(){var e=this;this.getRequest("/system/basic/deps").then(function(t){t&&200==t.status&&(e.allDeps=t.data)})},showAddDepView:function(e,t){this.loadAllDeps(),this.dialogVisible=!0,this.pDep=e.id,t.stopPropagation()?t.stopPropagation():window.event.cancelBubble=!0},deleteDep:function(e,t){var i=this;e.children.length>0?this.$message({message:"该部门下尚有其他部门，不能被删除!",type:"warning"}):this.$confirm("删除["+e.name+"]部门, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){i.treeLoading=!0,i.deleteRequest("/system/basic/dep/"+e.id).then(function(t){if(i.treeLoading=!1,t&&200==t.status){var s=t.data;i.$message({message:s.msg,type:s.status}),i.deleteLocalDep(i.treeData,e)}})}).catch(function(){i.$message({type:"info",message:"已取消删除"})}),t.stopPropagation()?t.stopPropagation():window.event.cancelBubble=!0},deleteLocalDep:function(e,t){for(var i=0;i<e.length;i++){var s=e[i];if(s.id==t.id)return void e.splice(i,1);this.deleteLocalDep(s.children,t)}},renderContent:function(e,t){var i=this,s=t.node,a=t.data;t.store;return e("span",{class:"spanlist"},[e("span",[s.label]),e("span",[e("el-button",{class:"add",on:{click:function(){return i.showAddDepView(a,window.event)}}},["添加部门"]),e("el-button",{class:"del",on:{click:function(){return i.deleteDep(a,window.event)}}},["删除部门"])])])}}},a={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticStyle:{"text-align":"left"}},[i("el-input",{staticStyle:{width:"100%",margin:"0px",padding:"0px",color:"#b7b7b9",border:"#dbdcdf"},attrs:{placeholder:"输入名称搜索部门或小组...","prefix-icon":"el-icon-search"},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}})],1),e._v(" "),i("div",[i("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.treeLoading,expression:"treeLoading"}],ref:"tree",staticStyle:{width:"100%","margin-top":"10px"},attrs:{props:e.defaultProps,data:e.treeData,"filter-node-method":e.filterNode,"render-content":e.renderContent}}),e._v(" "),i("div",{staticStyle:{"text-align":"left"}},[i("el-dialog",{attrs:{title:"添加部门",visible:e.dialogVisible,width:"20%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("div",{staticStyle:{"margin-top":"20px"}},[i("span",[e._v("上级部门:")]),e._v(" "),i("el-select",{staticStyle:{"margin-left":"20px"},attrs:{placeholder:"请选择"},model:{value:e.pDep,callback:function(t){e.pDep=t},expression:"pDep"}},e._l(e.allDeps,function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),i("div",{staticStyle:{"margin-top":"20px"}},[i("span",[e._v("部门名称:")]),e._v(" "),i("el-input",{staticStyle:{"margin-left":"20px",width:"220px"},attrs:{placeholder:"请输入部门名称..."},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.addDep(t):null}},model:{value:e.depName,callback:function(t){e.depName=t},expression:"depName"}})],1),e._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),e._v(" "),i("el-button",{staticClass:"myButtonQ",attrs:{type:"primary"},on:{click:e.addDep}},[e._v("添加")])],1)])],1)],1)])},staticRenderFns:[]};var l=i("VU/8")(s,a,!1,function(e){i("HfvY")},null,null);t.default=l.exports},dcSv:function(e,t){},"de6+":function(e,t){},ewEk:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={data:function(){return{keywords:"",fullloading:!1,hrs:[],cardLoading:[],eploading:[],allRoles:[],moreBtnState:!1,selRoles:[],selRolesBak:[],depId:1,deps:[]}},mounted:function(){this.initCards(),this.loadAllRoles(),this.loadDeps()},methods:{loadDeps:function(){var e=this;this.getRequest("/dept/deps").then(function(t){t&&200==t.status&&(e.deps=t.data)})},searchClick:function(){this.initCards(),this.loadAllRoles()},updateHrRoles:function(e,t){this.moreBtnState=!1;var i=this;if(this.selRolesBak.length==this.selRoles.length){for(var s=0;s<this.selRoles.length;s++)for(var a=0;a<this.selRolesBak.length;a++)if(this.selRoles[s]==this.selRolesBak[a]){this.selRolesBak.splice(a,1);break}if(0==this.selRolesBak.length)return}this.eploading.splice(t,1,!0),this.putRequest("/system/hr/roles",{hrId:e,rids:this.selRoles}).then(function(s){if(i.eploading.splice(t,1,!1),s&&200==s.status){var a=s.data;i.$message({type:a.status,message:a.msg}),"success"==a.status&&i.refreshHr(e,t)}})},refreshHr:function(e,t){var i=this;i.cardLoading.splice(t,1,!0),this.putRequest("/system/hr/id/"+e).then(function(e){i.cardLoading.splice(t,1,!1),i.hrs.splice(t,1,e.data)})},loadSelRoles:function(e,t){var i=this;this.moreBtnState=!0,this.selRoles=[],this.selRolesBak=[],e.forEach(function(e){i.selRoles.push(e.id),i.selRolesBak.push(e.id)})},loadAllRoles:function(){var e=this;this.getRequest("/system/basic/roles").then(function(t){e.fullloading=!1,t&&200==t.status&&(e.allRoles=t.data)})},switchChange:function(e,t,i){var s=this;s.cardLoading.splice(i,1,!0),this.putRequest("/system/hr/",{enabled:e,id:t}).then(function(e){if(s.cardLoading.splice(i,1,!1),e&&200==e.status){var a=e.data;s.$message({type:a.status,message:a.msg}),"error"==a.status&&s.refreshHr(t,i)}else s.refreshHr(t,i)})},deptChange:function(e,t,i){var s=this;s.cardLoading.splice(i,1,!0),this.putRequest("/system/hr/dept",{dept:e,id:t}).then(function(e){if(s.cardLoading.splice(i,1,!1),e&&200==e.status){var a=e.data;s.$message({type:a.status,message:a.msg}),"error"==a.status&&s.refreshHr(t,i)}else s.refreshHr(t,i)})},initCards:function(){this.fullloading=!0;var e,t=this;e=""===this.keywords?"all":this.keywords,this.getRequest("/system/hr/"+e).then(function(e){if(e&&200==e.status){t.hrs=e.data;var i=e.data.length;t.cardLoading=Array.apply(null,Array(i)).map(function(e,t){return!1}),t.eploading=Array.apply(null,Array(i)).map(function(e,t){return!1})}})},deleteHr:function(e){if(!confirm("")){var t=this;this.fullloading=!0,this.deleteRequest("/system/hr/"+e).then(function(e){if(t.fullloading=!1,e&&200==e.status){var i=e.data;t.$message({type:i.status,message:i.msg}),"success"==i.status&&(t.initCards(),t.loadAllRoles())}})}}}},a={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.fullloading,expression:"fullloading"}],staticStyle:{"margin-top":"22px"}},[i("div",{staticStyle:{"margin-bottom":"10px",display:"flex","justify-content":"center","align-items":"center"}},[i("el-input",{staticStyle:{width:"100%","margin-right":"10px"},attrs:{placeholder:"默认显示除管理员外的所有用户，可以通过用户名模糊查询...","prefix-icon":"el-icon-search",size:"small"},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}}),e._v(" "),i("el-button",{staticClass:"myButtonQ",attrs:{size:"mini",type:"primary",icon:"el-icon-search"},on:{click:e.searchClick}},[e._v("搜索")])],1),e._v(" "),i("div",{staticStyle:{display:"flex","justify-content":"normal","flex-wrap":"wrap","text-align":"left"}},e._l(e.hrs,function(t,s){return i("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.cardLoading[s],expression:"cardLoading[index]"}],key:t.id,staticClass:"myCard"},[i("div",[i("div",[i("div",[i("span",{staticClass:"user-info"},[e._v("用户名称:")]),i("span",{staticClass:"user-detail"},[e._v(e._s(t.username)+" "+e._s("(")+e._s(t.name)+e._s(")"))])]),e._v(" "),i("div",[i("span",{staticClass:"user-info"},[e._v("手机号码:")]),i("span",{staticClass:"user-detail"},[e._v(e._s(t.phone))])]),e._v(" "),i("div",[i("span",{staticClass:"user-info"},[e._v("电子邮件:")]),i("span",{staticClass:"user-detail"},[e._v(e._s(t.email))])]),e._v(" "),i("div",{staticClass:"user-info",staticStyle:{display:"flex","align-items":"center","margin-bottom":"3px"}},[e._v("\n              用户状态:\n              "),i("el-switch",{key:t.id,staticStyle:{"margin-left":"29px"},attrs:{"active-color":"#6798ec","inactive-color":"#aaaaaa","active-text":"启用","inactive-text":"禁用"},on:{change:function(i){e.switchChange(t.enabled,t.id,s)}},model:{value:t.enabled,callback:function(i){e.$set(t,"enabled",i)},expression:"item.enabled"}})],1),e._v(" "),i("div",{staticClass:"user-info"},[e._v("\n              用户角色:\n              "),e._l(t.roles,function(t){return i("el-tag",{key:t.id,staticStyle:{"margin-right":"2px","margin-left":"25px"},attrs:{type:"success",size:"mini","disable-transitions":!0}},[e._v(e._s(t.nameZh)+"\n              ")])}),e._v(" "),i("el-popover",{directives:[{name:"loading",rawName:"v-loading",value:e.eploading[s],expression:"eploading[index]"}],key:t.id,attrs:{placement:"right",title:"角色列表",width:"100",trigger:"click"},on:{hide:function(i){e.updateHrRoles(t.id,s)}}},[i("el-select",{attrs:{multiple:"",placeholder:"请选择角色"},model:{value:e.selRoles,callback:function(t){e.selRoles=t},expression:"selRoles"}},e._l(e.allRoles,function(e){return i("el-option",{key:e.id,attrs:{label:e.nameZh,value:e.id}})}),1),e._v(" "),i("el-button",{staticStyle:{color:"#09c0f6","padding-top":"0px"},attrs:{slot:"reference",type:"text",icon:"el-icon-more",disabled:e.moreBtnState},on:{click:function(i){e.loadSelRoles(t.roles,s)}},slot:"reference"})],1)],2),e._v(" "),i("div",{staticClass:"user-info"},[i("span",{staticClass:"user-info"},[e._v("用户部门:\n                "),i("el-select",{key:t.id,staticStyle:{"margin-left":"25px"},attrs:{size:"mini",placeholder:"请选择部门"},on:{change:function(i){e.deptChange(t.dept,t.id,s)}},model:{value:t.dept,callback:function(i){e.$set(t,"dept",i)},expression:"item.dept"}},e._l(e.deps,function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1)])])])])}),1)])},staticRenderFns:[]};var l=i("VU/8")(s,a,!1,function(e){i("s3vR")},"data-v-546fab5a",null);t.default=l.exports},fc7a:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i("Bg5L"),a=i("aS53"),l={data:function(){return{defaultTab:"depMana"}},methods:{},components:{"menu-role":s.default,"dep-mana":a.default}},o={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{"margin-top":"22px"}},[i("el-tabs",{staticClass:"sysbasic",attrs:{type:"card"},model:{value:e.defaultTab,callback:function(t){e.defaultTab=t},expression:"defaultTab"}},[i("el-tab-pane",{attrs:{label:"部门管理",name:"depMana"}},[i("dep-mana")],1),e._v(" "),i("el-tab-pane",{attrs:{label:"权限组",name:"menuRole"}},[i("menu-role")],1)],1)],1)},staticRenderFns:[]};var n=i("VU/8")(l,o,!1,function(e){i("F+2t")},"data-v-2fba80d0",null);t.default=n.exports},m12F:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{"margin-top":"22px"}},[i("el-container",[i("el-main",{staticStyle:{"padding-left":"0px","padding-top":"0px"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.advanceSearchViewVisible,expression:"advanceSearchViewVisible"}],staticClass:"search-box"},[i("el-row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[i("el-col",{attrs:{span:6}},[i("el-input",{staticStyle:{width:"97%"},attrs:{placeholder:"请输入工单编号...","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.searchTicket(t):null}},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}})],1),e._v(" "),i("el-col",{attrs:{span:6}},[i("el-select",{staticStyle:{width:"97%"},attrs:{placeholder:"请选择申报形式"},model:{value:e.ticket.declarationId,callback:function(t){e.$set(e.ticket,"declarationId",t)},expression:"ticket.declarationId"}},e._l(e.declarations,function(e){return i("el-option",{key:e.declaration_id,attrs:{label:e.description,value:e.declaration_id}})}),1)],1),e._v(" "),i("el-col",{attrs:{span:6}},[i("el-select",{staticStyle:{width:"97%"},attrs:{placeholder:"请选择来源分类"},model:{value:e.ticket.sourceId,callback:function(t){e.$set(e.ticket,"sourceId",t)},expression:"ticket.sourceId"}},e._l(e.sources,function(e){return i("el-option",{key:e.source_id,attrs:{label:e.description,value:e.source_id}})}),1)],1),e._v(" "),i("el-col",{attrs:{span:6}},[i("el-select",{staticStyle:{width:"97%"},attrs:{placeholder:"请选择服务分类"},model:{value:e.ticket.serverId,callback:function(t){e.$set(e.ticket,"serverId",t)},expression:"ticket.serverId"}},e._l(e.servers,function(e){return i("el-option",{key:e.server_id,attrs:{label:e.description,value:e.server_id}})}),1)],1)],1),e._v(" "),i("el-row",{staticStyle:{"margin-bottom":"0px"}},[i("el-col",{attrs:{span:6}},[i("el-select",{staticStyle:{width:"97%"},attrs:{placeholder:"请选择影响范围"},model:{value:e.ticket.affectId,callback:function(t){e.$set(e.ticket,"affectId",t)},expression:"ticket.affectId"}},e._l(e.affects,function(e){return i("el-option",{key:e.affect_id,attrs:{label:e.description,value:e.affect_id}})}),1)],1),e._v(" "),i("el-col",{attrs:{span:6}},[i("el-select",{staticStyle:{width:"97%"},attrs:{placeholder:"请选择优先级"},model:{value:e.ticket.priorityId,callback:function(t){e.$set(e.ticket,"priorityId",t)},expression:"ticket.priorityId"}},e._l(e.priorities,function(e){return i("el-option",{key:e.priority_id,attrs:{label:e.description,value:e.priority_id}})}),1)],1),e._v(" "),i("el-col",{attrs:{span:6}},[i("el-select",{staticStyle:{width:"97%"},attrs:{placeholder:"请选择工单状态"},model:{value:e.ticket.status,callback:function(t){e.$set(e.ticket,"status",t)},expression:"ticket.status"}},e._l(e.statuses,function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),i("el-col",{attrs:{span:6}},[i("el-badge",{staticStyle:{width:"97%"}},[i("el-tooltip",{attrs:{effect:"light",content:"查询",placement:"left"}}),e._v(" "),i("el-button",{staticClass:"myButtonQ",attrs:{size:"mini",type:"primary",icon:"el-icon-search"},on:{click:e.searchTicket}},[e._v("查询")]),e._v("\n                      \n              "),i("el-tooltip",{attrs:{effect:"light",content:"刷新",placement:"right"}}),e._v(" "),i("el-button",{staticClass:"myButtonR",attrs:{size:"mini",type:"success",icon:"el-icon-refresh"},on:{click:e.cancelSearch}},[e._v("刷新")])],1)],1)],1)],1),e._v(" "),i("div",{staticClass:"myTable",staticStyle:{"margin-top":"15px"}},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{data:e.tickets,border:"",stripe:"",size:"mini","header-cell-style":{background:"#f0f0f0",color:"#68727c"}},on:{"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{prop:"logId",fixed:"left",label:"工单编号",width:"140",align:"left","show-overflow-tooltip":"true"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("router-link",{staticStyle:{color:"#0b6dd8","text-decoration":"none"},attrs:{to:{path:"/tkt/detail",query:{index:t.$index,row:t.row,backroute:"/tkt/new"}}}},[e._v("\n                "+e._s(t.row.logId)+"\n              ")])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"150",label:"工单生成时间",align:"left","show-overflow-tooltip":"true"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("formatDateTime")(t.row.createdDate)))]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"title",label:"事件标题",width:"150",align:"left","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{prop:"customerName",label:"申报人",width:"120",align:"left","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{prop:"customerId",label:"申报人组织",width:"120",align:"left","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{prop:"mobile",label:"申报人手机",width:"120",align:"left","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{prop:"tel",label:"申报人座机",width:"120",align:"left","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{prop:"email",label:"申报人邮箱",width:"150",align:"left","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{prop:"vipdesc",label:"VIP",width:"120",align:"left","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"declaration.description",label:"申报形式","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"source.description",label:"来源分类","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"server.description",label:"服务分类","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"questiontype.description",label:"问题分类","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"subclass.description",label:"问题子分类","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"affect.description",label:"影响范围","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"priority.description",label:"优先级","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"emailGroup.description",label:"转发地址","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{width:"100",prop:"hr.name",label:"责任人","show-overflow-tooltip":"true"}}),e._v(" "),i("el-table-column",{attrs:{fixed:"right",prop:"status",label:"工单状态",width:"135",align:"left","show-overflow-tooltip":"true"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-tag",{attrs:{type:e._f("statusFilter")(t.row.status)}},[e._v(e._s(t.row.status))]),e._v(" "),i("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:"分配",placement:"top"}}),e._v(" "),"New"==t.row.status?i("el-tag",{attrs:{type:"danger"},nativeOn:{click:function(i){e.showEditTicketView(t.$index,t.row)}}},[i("i",{staticClass:"el-icon-edit-outline"},[e._v(e._s("分配"))])]):e._e()]}}])})],1),e._v(" "),i("div",{staticStyle:{padding:"20px 5px"}},[i("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)])],1),e._v(" "),i("el-form",{ref:"assignTicketForm",attrs:{model:e.ticket,rules:e.rules}},[i("div",{staticClass:"myDialog"},[i("el-dialog",{attrs:{title:e.ticketEdit,visible:e.dialogVisible,width:"20%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("div",{staticClass:"mt20"}),e._v(" "),i("el-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{disabled:!0,placeholder:"请输入新的工单编号..."},model:{value:e.updateLogId,callback:function(t){e.updateLogId=t},expression:"updateLogId"}}),e._v(" "),i("el-form-item",{attrs:{"label-width":"90px",label:"责任人:",prop:"assigneeId"}},[i("el-select",{attrs:{placeholder:"请选择责任人"},on:{change:e.currentSel},model:{value:e.ticket.assigneeId,callback:function(t){e.$set(e.ticket,"assigneeId",t)},expression:"ticket.assigneeId"}},e._l(e.assignees,function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),i("div",{staticClass:"mt10"}),e._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{staticClass:"myButtonQ",attrs:{type:"primary"},on:{click:e.updateTicketExec}},[e._v("确 定")])],1)],1)],1)])],1)},staticRenderFns:[]};var a=i("VU/8")({components:{},name:"TicketListTable",filters:{statusFilter:function(e){return{New:"danger",Assigned:"warning","In progress":"",Pending:"",Resolved:"info",Closed:"success"}[e]}},data:function(){return{tickets:[],keywords:"",title:"",positionName:"",declarations:[],sources:[],priorities:[],servers:[],affects:[],assignees:[],emailgroups:[],status:"",updateLogId:"",rowindex:"",assignee:"",updateTitleLevel:"",faangledoubleup:"fa-angle-double-up",faangledoubledown:"fa-angle-double-down",ticketEdit:"分配工单",titleLevel:"",updatePosId:-1,totalCount:-1,currentPage:1,pageSize:10,tableLoading:!1,dialogVisible:!1,multipleSelection:[],type:[],statuses:["New","Assigned","In progress","Pending","Closed"],advanceSearchViewVisible:!0,ticket:{logId:"",title:"",createdDate:"",customerName:"",customerId:"",mobile:"",tel:"",email:"",vipdesc:"",status:"",declarationId:"",sourceId:"",serverId:"",affectId:"",priorityId:"",assigneeId:"",groupId:""},hr:{address:"",dept:"",enabled:"",id:"",name:"",phone:"",roles:"",email:"",userface:"",username:""},rules:{declarationId:[{required:!0,message:"必填:申报形式",trigger:"change"}]}}},mounted:function(){this.initData(),this.loadTickets()},methods:{updateTicketExec:function(){var e=this;if(this.isNotNullORBlank(this.updateLogId)){this.tableLoading=!0;var t=this;this.putRequest("/ticket/basic/assign",{logId:this.updateLogId,assigneeId:this.ticket.assigneeId}).then(function(i){if(t.tableLoading=!1,i&&200==i.status){e.dialogVisible=!1;var s=i.data;t.$message({type:s.status,message:s.msg}),e.emptyTicketList(),e.loadTickets(),e.postRequest("/chat/nf",{message:e.updateLogId+" 已被分配给 "+e.assignee,title:e.updateLogId+" 已被分配给 "+e.assignee}).then(function(e){e&&200==e.status&&"success"==e.data.status&&(t.$store.commit("toggleNFDot",!0),t.$store.state.stomp.send("/ws/nf",{},""),t.initSysMsgs(),t.cancelSend())})}})}else this.$message.warning("工单编号不能为空!")},currentSel:function(e){var t;t=this.assignees.find(function(t){return t.id===e}),this.assignee=t.name},cancelSearch:function(){this.advanceSearchViewVisible=!0,this.emptyTicketList(),this.loadTickets()},handleSelectionChange:function(e){this.multipleSelection=e},handleDelete:function(e,t){var i=this,s=this;this.$confirm("删除["+t.name+"], 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.doDelete(t.id)}).catch(function(){i.$message({type:"info",message:"已取消删除"})})},doDelete:function(e){var t=this;t.tableLoading=!0,this.deleteRequest("/system/basic/joblevel/"+e).then(function(e){t.tableLoading=!1,e&&200==e.status&&t.loadTableData()})},loadTableData:function(){var e=this;this.tableLoading=!0,this.getRequest("/ticket/tickets").then(function(t){e.tableLoading=!1})},initData:function(){var e=this;this.getRequest("/ticket/basic/lovdata").then(function(t){if(t&&200==t.status){var i=t.data;e.declarations=i.declarations,e.sources=i.sources,e.priorities=i.priorities,e.servers=i.servers,e.questiontypes=i.questiontypes,e.subclasses=i.subclasses,e.affects=i.affects,e.assignees=i.assignees,e.emailgroups=i.emailgroups}})},showEditTicketView:function(e,t){this.rowindex=e,this.updateLogId=t.logId,this.dialogVisible=!0},searchTicket:function(){this.loadTickets()},handleSizeChange:function(e){this.pageSize=e,this.loadTickets()},handleCurrentChange:function(e){this.currentPage=e,this.loadTickets()},loadTickets:function(){var e=this,t=this;this.tableLoading=!0,this.getRequest("/ticket/basic/tkt?page="+this.currentPage+"&size="+this.pageSize+"&keywords="+this.keywords+"&declarationId="+this.ticket.declarationId+"&sourceId="+this.ticket.sourceId+"&serverId="+this.ticket.serverId+"&affectId="+this.ticket.affectId+"&priorityId="+this.ticket.priorityId+"&status=New&assigneeId="+this.ticket.assigneeId+"&groupId="+this.ticket.groupId).then(function(i){if(e.tableLoading=!1,i&&200==i.status){var s=i.data;t.tickets=s.tickets,t.totalCount=s.count}})},emptyTicketList:function(){this.ticket={logId:"",title:"",createdDate:"",customerName:"",customerId:"",mobile:"",tel:"",email:"",vipdesc:"",status:"",declarationId:"",sourceId:"",serverId:"",affectId:"",priorityId:"",assigneeId:"",groupId:"",rowindex:""},this.keywords=""}},computed:{user:function(){return this.$store.state.user},routes:function(){return this.$store.state.routes}}},s,!1,function(e){i("de6+")},"data-v-5dc68be1",null);t.default=a.exports},qPzJ:function(e,t){},s3vR:function(e,t){}});